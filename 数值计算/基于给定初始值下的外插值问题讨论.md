# 基于给定初始值下的外插值问题讨论

#### 南樟 18342077 软件工程

### 一、问题重述

​	对递增的2个数据1920.03和1945.81尝试用各种不同函数、公式或方法进行插值建模，进行外插值/外推计算，以求出该递增2数据的下一个数据（也即第3个数据）是多少？



### 二、问题分析

​	首先对于这两个数据之间的间距和具体位置进行假设，然后再根据不同的外插值计算方法以及不同的外插值函数模型进行推导和计算。

​	根据所学过的知识以及查阅到的资料，我选择了以下几个方法进行讨论：

1. ​	拉格朗日插值
2. ​    牛顿插值
3. ​    埃尔米特插值
5. ​    样条插值

​    由于题干中并没有提到关于这两个数据的初始位置，所以对于两个数据的初始位置的假设也是题目分析所要做到的一项任务。考虑到题干中理论上大于2019.79，那么大概就不会是一次二次这样的函数，因为增长速度不够，但是由于内容的完整性，所以在这里还是仍要讨论一下。

### 三、基于初始值为（0，1920.03）与（1，1945.81）的讨论

初始值
$$
x_0=0;x_1=1;f(x_0)=1920.03;f(x_1)=1945.81;f'(x_0)=\frac{1}{2};f'(x_1)=\frac{1}{2}
$$


#### 	1.拉格朗日插值：


$$
l_j(x)=\coprod_{i=0,i\ne j}^k \frac{x-x_i}{x_j-x_i}
$$

#### 	

$$
l_0(x)=\frac{(x-x_1)}{(x_0-x_1)}=1-x
$$

#### 	

$$
l_1(x)=\frac{(x-x_0)}{x_1-x_0}=x
$$

$$
\phi_1(x)=y_0l_0(x)+y_1l_1(x)=1920.03*(1-x)+1945.81*x=25.78x+1920.03
$$

此时:
$$
x2=2;\phi_1(x2)=25.78*2+1920.03=1971.59
$$


#### 	2.牛顿插值

$$
N(x)=f(x_0)+(x-x_0)f[x0,x1]+…+x(x-x_0)…(x-x_n-1)f[x0,x1,…,x_n]
$$

$$
f[x_0,x_1]=\frac{f(x_0)-f(x_1)}{x_0-x_1}=25.78
$$

$$
\phi_1(x)=f(x_0)+(x-x_0)f[x_0,x_1]=25.78x+1920.03
$$

此时:
$$
x2=2;\phi_1(x2)=25.78*2+1920.03=1971.59
$$

#### 	3.埃尔米特插值

$$
H(x_i)=f(x_i),H'(x_i)=f'(x_i)
$$

$$
h_0(x)=(1+2\frac{x-x_0}{x_1-x_0})(\frac{x-x_1}{x_0-x_1})^2=2x^3-3x^2+1
$$

$$
h_1(x)=(1+2\frac{x-x_1}{x_0-x_1})(\frac{x-x_0}{x_1-x_0})^2=-2x^3+3x^2
$$

$$
H_0(x)=(x-x_0)(\frac{x-x_1}{x_0-x_1})^2=x^3-2x^2+x
$$

$$
H_1(x)=(x-x_1)(\frac{x-x_0}{x_1-x_0})^2=x^3-x^2
$$

因此
$$
H(x)=y_0h_0(x)+y_1h_1(x)+y_0H_0(x)+y_1H_1(x)
$$

$$
=3814.28x^3-5708.53x^2+1920.03x+1920.03
$$

此时
$$
x_2=2;H(x_2)=13440.21
$$

#### 	


#### 	4.样条插值

$$
s(x_i)=y_i(i=0,1,…,n)
$$

$$
2(h_0+h_1)m_1+h_1m_2=u_1-h_0m_0
$$

$$
h_0=1;h_1=1;d_0=0;d_1=25.78;u_1=154.68
$$

##### 4.1自然样条曲线Natural Spline

$$
m_0=m_2=0
$$

那么根据公式可以得到
$$
m_1=38.67
$$
那么带入公式可得
$$
S_0(x)=-\frac{m_0}{6h_0}(x_1-x)^3+\frac{m_1}{6h_0}(x-x_0)^3+(\frac{y_0}{h_0}-\frac{m_0h_0}{6})(x_1-x)+(\frac{y_1}{h_0}-\frac{m_1h_0}{6})(x-x_0)
$$

$$
=6.445x^3+25.78x+1920.03
$$

此时
$$
x_2=2;S_0(x_2)=2023.15
$$

##### 4.2端点调整样条曲线Endpoint Adjusted Spline

$$
m_0=m_1=m_2
$$

那么可以根据公式得到
$$
m_1=25.78
$$
那么带入公式可得
$$
S_0(x)=-\frac{m_0}{6h_0}(x_1-x)^3+\frac{m_1}{6h_0}(x-x_0)^3+(\frac{y_0}{h_0}-\frac{m_0h_0}{6})(x_1-x)+(\frac{y_1}{h_0}-\frac{m_1h_0}{6})(x-x_0)
$$

$$
=8.59x^3+12.89x^2+38.67x+1281.44
$$

此时
$$
x_2=2;S_0(x_2)=1479.06
$$


### 四、基于初始值为（-1，1920.03）与（1，1945.81）的讨论

初始值
$$
x_0=-1;x_1=1;f(x_0)=1920.03;f(x_1)=1945.81;f'(x_0)=\frac{1}{2};f'(x_1)=\frac{1}{2}
$$


#### 	1.拉格朗日插值：


$$
l_j(x)=\coprod_{i=0,i\ne j}^k \frac{x-x_i}{x_j-x_i}
$$

#### 	

$$
l_0(x)=\frac{(x-x_1)}{(x_0-x_1)}=\frac{1-x}{2}
$$

#### 	

$$
l_1(x)=\frac{(x-x_0)}{x_1-x_0}=\frac{x+1}{2}
$$

$$
\phi_1(x)=y_0l_0(x)+y_1l_1(x)=1920.03*\frac{1-x}{2}+1945.81*\frac{x+1}{2}=12.89x+1932.92
$$

此时:
$$
x2=3;\phi_1(x2)=12.89*3+1932.92=1971.59
$$


#### 	2.牛顿插值

$$
N(x)=f(x_0)+(x-x_0)f[x0,x1]+…+x(x-x_0)…(x-x_n-1)f[x0,x1,…,x_n]
$$

$$
f[x_0,x_1]=\frac{f(x_0)-f(x_1)}{x_0-x_1}=12.89
$$

$$
\phi_1(x)=f(x_0)+(x-x_0)f[x_0,x_1]=12.89x+1932.92
$$

此时:
$$
x2=3;\phi_1(x2)=12.89*3+1932.92=1971.59
$$

#### 	3.埃尔米特插值

$$
H(x_i)=f(x_i),H'(x_i)=f'(x_i)
$$

$$
h_0(x)=(1+2\frac{x-x_0}{x_1-x_0})(\frac{x-x_1}{x_0-x_1})^2=\frac{x^3-3x+2}{4}
$$

$$
h_1(x)=(1+2\frac{x-x_1}{x_0-x_1})(\frac{x-x_0}{x_1-x_0})^2=-\frac{-x^3+3x+2}{4}
$$

$$
H_0(x)=(x-x_0)(\frac{x-x_1}{x_0-x_1})^2=\frac{x^3-x^2-x+1}{4}
$$

$$
H_1(x)=(x-x_1)(\frac{x-x_0}{x_1-x_0})^2=\frac{x^3+x^2-x-1}{4}
$$

因此
$$
H(x)=y_0h_0(x)+y_1h_1(x)+y_0H_0(x)+y_1H_1(x)
$$

$$
=960.015x^3+6.445x^2-947.125x+1926.475
$$

此时
$$
x_2=3;H(x_2)=25063.51
$$

#### 	


#### 	4.样条插值

$$
s(x_i)=y_i(i=0,1,…,n)
$$

$$
2(h_0+h_1)m_1+h_1m_2=u_1-h_0m_0
$$

$$
h_0=2;h_1=2;d_0=0;d_1=12.89;u_1=77.34
$$

##### 4.1自然样条曲线Natural Spline

$$
m_0=m_2=0
$$

那么根据公式可以得到
$$
m_1=9.6675
$$
那么带入公式可得
$$
S_0(x)=-\frac{m_0}{6h_0}(x_1-x)^3+\frac{m_1}{6h_0}(x-x_0)^3+(\frac{y_0}{h_0}-\frac{m_0h_0}{6})(x_1-x)+(\frac{y_1}{h_0}-\frac{m_1h_0}{6})(x-x_0)
$$

$$
=0.805625x^3+2.416875x^2+10.084375x+1927.7780625
$$

此时
$$
x_2=3;S_0(x_2)=2001.5349375
$$

##### 4.2端点调整样条曲线Endpoint Adjusted Spline

$$
m_0=m_1=m_2
$$

那么可以根据公式得到
$$
m_1=6.445
$$
那么带入公式可得
$$
S_0(x)=-\frac{m_0}{6h_0}(x_1-x)^3+\frac{m_1}{6h_0}(x-x_0)^3+(\frac{y_0}{h_0}-\frac{m_0h_0}{6})(x_1-x)+(\frac{y_1}{h_0}-\frac{m_1h_0}{6})(x-x_0)
$$

$$
=1.07417x^3+16.1125x+1924.3266
$$

此时
$$
x_2=3;S_0(x_2)=2001.66669
$$

### 五、结论和分析

从这次讨论中我们可以看出，在仅有两个点的情况下，拉格朗日插值法以及牛顿插值法都会退化为线性，无论取值如何，求出的下一个数据点的值都是固定的。

其次是埃尔米特插值，尽管给了很多的参数，也满足了要求，但是我们可以发现该插值的误差是最大的，可以说超出了一个量级，这让我百思不得其解，理论上每个插值方法存在必定有他的道理，也许是因为我的初始值设置的不合理而导致这个方法计算出来与期望值相差甚远。

最后是样条，在本次尝试的插值方法中，样条是相对可靠的，并且计算出的结果也比较接近于老师给的数字，但是由于部分样条的计算过程过于繁琐，所以在本文中就没有使用，仅使用两种较为简单的样条进行计算。

实际上，常用的插值方法还有一种称之为线性区间插值，但是由于本题仅有两点的数据，即区间只有一个，该方法最终也会退化为线性，与拉格朗日插值和牛顿插值计算结果相同，所以就没有论述。